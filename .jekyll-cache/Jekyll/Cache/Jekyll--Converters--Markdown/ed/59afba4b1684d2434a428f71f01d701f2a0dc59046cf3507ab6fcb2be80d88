I"˜]<h1 id="vue2--composition-api-ê²½í—˜-ì •ë¦¬">Vue2 &amp; Composition-Api ê²½í—˜ ì •ë¦¬</h1>

<blockquote>
  <p>Composition-Api ëŠ” Vue 3ì— ë‚´ì¥ ë˜ì–´ ìˆëŠ” api ì´ë‹¤.
í•´ë‹¹ apiëŠ” ë””ìŠ¤í¬ ì¡°ê° ëª¨ìŒê³¼ ê°™ì´, Vue 2ì—ì„œ ì‚¬ìš©í•˜ëŠ” options ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì—ì„œ ë°œìƒí•˜ëŠ” ì¡°ê° ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
ì¦‰, ê´€ë ¨ëœ options(data, method, computed etcâ€¦)ê°€ .vue íŒŒì¼ì— ì—¬ê¸°ì €ê¸° í©ì–´ì§€ëŠ” í˜„ìƒì„ ê´€ì‹¬ì‚¬ ë³„ë¡œ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ ì¥ì ì´ë‹¤.
ë˜í•œ í•´ë‹¹ ê´€ì‹¬ì‚¬ ë³„ë¡œ ëª¨ë“  LifeCycleì„ Setup ì•ˆì—ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—
â€˜ëª¨ì•„ ë†“ê¸°ë§Œ í•˜ë©´ í•œëˆˆì—â€™ê°€ ê°€ëŠ¥í•´ ì§ˆ ìˆ˜ ìˆë‹¤.</p>
</blockquote>

<p>ê·¸ëŸ¬ë¯€ë¡œ, â€˜Vue2â€™ì—ì„œ Compositionì„ ì ìš©í–ˆì„ ë•Œ ìƒê²¨ë‚œ ê²½í—˜ì„ ì •ë¦¬í•´ ë³´ê³ ì í•œë‹¤.</p>

<h2 id="1-ref--reactive">1. Ref &amp; Reactive</h2>

<p>í•´ë‹¹ ë³€ìˆ˜ ì„ ì–¸ì—ì„œ ê°€ì¥ ì™€ë‹¿ì•˜ë˜ ê²ƒì€ Composable í•˜ê²Œ ë‚˜ëˆ„ì—ˆì„ ë•Œ ë°œìƒí–ˆë‹¤.
ë¨¼ì €, Vue2ì—ì„œ ê´€ë ¨í•œ ìƒí™©ê³¼ ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ì—¬ Composition í–ˆì„ ë•Œì˜ ìƒí™© ë‘ ìƒí™©ì„ ë¹„êµí•´ë³´ì</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
ìƒí™© ì„¤ëª… : pageë¥¼ ì´ë™í•  ë•Œ ë§ˆë‹¤, api callì„ í•´ì•¼í•œë‹¤.
(ë‘ ë©”ì†Œë“œëŠ” paginate ê´€ì‹¬ê³¼ fetchData ê´€ì‹¬ ë¶„ë¦¬ë¡œ ê°€ì •)
ê´€ì‹¬ì‚¬ëŠ” ë‹¤ë¥´ì§€ë§Œ, ì‚¬ìš©í•  ë³€ìˆ˜ê°€ ê³µìœ ë˜ì–´ì•¼ë§Œ í•˜ëŠ” ê²½ìš°.
*/</span>
<span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">return</span> <span class="p">{</span>
		<span class="na">page</span><span class="p">:</span> <span class="mi">0</span> <span class="k">as</span> <span class="kr">number</span><span class="p">,</span>
	<span class="p">}</span>
<span class="p">},</span>

<span class="nx">methods</span><span class="p">:</span> <span class="p">{</span>
	<span class="nx">chnagePage</span><span class="p">(</span><span class="nx">pageNumber</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
	  <span class="k">this</span><span class="p">.</span><span class="nx">page</span> <span class="o">=</span> <span class="nx">pageNumber</span><span class="p">;</span>
  <span class="p">},</span>

  <span class="nx">getContact</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">parameter</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">page</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">page</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="dl">'</span><span class="s1">/dataget</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="nx">parameter</span> <span class="p">}).</span><span class="kd">get</span><span class="p">()...</span><span class="nx">apicall</span><span class="p">...</span>
		
		<span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
  <span class="p">}</span> 
<span class="p">}</span>
</code></pre></div></div>

<p>ë‹¨ì ì¸ ì˜ˆì´ì§€ë§Œ, ìœ„ ì²˜ëŸ¼ â€˜pagination í•  ë•Œ ì‚¬ìš©í•  ê±°ì•¼!â€™, â€˜fetchData í•  ë•Œ ì‚¬ìš©í•  ê±°ì•¼!â€™ ë¼ê³  ë¶„ë¦¬ë¥¼ í–ˆì§€ë§Œ, ì„œë¡œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ê³µìœ í•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì´ ìƒê°ë³´ë‹¤ ì¦ë‹¤.
ìš°ë¦¬ê°€ Storeë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ì™€ ê°™ì´ ë³€ìˆ˜ëŠ” ìƒíƒœë¥¼ ë‹´ê³  ìˆê³ , ì´ ìƒíƒœê°€ íŠ¹ì • ë©”ì†Œë“œì—ì„œ ì‚¬ìš©ì´ í•„ìš”í•  ë•Œê°€ ìˆë‹¤.
Vue 2ì˜ Optionsì—ëŠ” ìœ„ ì²˜ëŸ¼ ì‚¬ìš©í•˜ë˜ ê²ƒì´, Compositionì„ ë„ì…í•¨ìœ¼ë¡œì„œ ê³ ë¯¼ì´ ìƒê¸´ë‹¤.</p>

<p>í•˜ë‚˜ì˜ Setupì— êµ¬ì„±í•  ë•ŒëŠ” ì‚¬ì‹¤ìƒ optionsì™€ ë‹¤ë¥¸ ì ì´ ì—†ì§€ë§Œ, Composableí•  ë•Œ ë³€ìˆ˜ëŠ” ì–´ë–»ê²Œ ë‹¤ë£¨ì§€? ì— ëŒ€í•œ ê³ ë¯¼ì´ë‹¤.
Compositonì˜ ì˜ˆë¥¼ ì‚´í´ë³´ì.</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// usePagination.ts</span>
<span class="kd">const</span> <span class="nx">usePagination</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="nx">page</span> <span class="o">=</span> <span class="nx">ref</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

	<span class="kd">const</span> <span class="nx">changePage</span> <span class="o">=</span> <span class="p">(</span><span class="na">pageNumber</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nx">page</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">pageNumber</span><span class="p">;</span>
	<span class="p">}</span>
	
	<span class="k">return</span> <span class="p">{</span> <span class="nx">page</span><span class="p">,</span> <span class="nx">changePage</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>í˜ì´ì§€ë„¤ì´ì…˜ì— ì‚¬ìš©ë˜ëŠ” optionsë¥¼ <code class="language-plaintext highlighter-rouge">usePagination.ts</code>ì— êµ¬ì„±í•˜ê³  page ë³€ìˆ˜ì™€ changePage í•¨ìˆ˜ë¥¼ return í–ˆë‹¤.</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// useFetchData.ts</span>
<span class="kd">const</span> <span class="nx">useFetchData</span> <span class="o">=</span> <span class="p">(</span><span class="nx">page</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="nx">parameter</span> <span class="o">=</span> <span class="p">{</span> <span class="na">page</span><span class="p">:</span> <span class="o">??</span><span class="p">?</span> <span class="p">}</span>
	
	<span class="kd">const</span> <span class="nx">getContact</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="dl">'</span><span class="s1">/dataget</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="nx">parameter</span> <span class="p">}).</span><span class="kd">get</span><span class="p">()...</span><span class="nx">apicall</span><span class="p">...</span>

		<span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
	<span class="p">}</span>
	
	<span class="k">return</span> <span class="p">{</span> <span class="nx">getContact</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ë‘ê°œì˜ íŒŒì¼ë¡œ ë¶„ë¦¬í•˜ê³  ë‚˜ë‹ˆ parameterì— ë„£ì„ page ì •ë³´ê°€ ì—†ë‹¤!
thisë¥¼ ì“°ì§€ ëª»í•˜ëŠ” ê²ƒì€ ë‘˜ ì§¸ ì¹˜ê³ , íŒŒì¼ì´ ë‹¤ë¥¸ë° ì–´ë–»ê²Œ ê°€ì ¸ì˜¤ì§€?ë¼ëŠ” ì˜ë¬¸ì´ ìƒê¸´ë‹¤.
â€˜ì—ì´~ íŒŒë¼ë¯¸í„°ë¡œ ê°€ì ¸ì˜¤ë©´ ë˜ì§€!â€™
ê·¼ë° ìì„¸íˆ ë³´ë©´ page ë³€ìˆ˜ëŠ” constì´ë‹¤.
ì´ê²ƒì´ composition-apië¥¼ ê²½í—˜í–ˆì„ ë•Œ ë‹¹í™©ìŠ¤ëŸ¬ì› ë˜ ë¶€ë¶„ì´ë‹¤.</p>

<p>ê²°ë¡ ë¶€í„° ì–˜ê¸°í•˜ìë©´, refí™”(refë¥¼ ì‚¬ìš© í˜¹ì€ reactiveë¥¼ toRef)ë¥¼ í•´ì£¼ë©´ ëœë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{_isRef: true}
value: (...)
_isRef: true
get value: Æ’ value()
set value: Æ’ value(newVal)
__proto__: Object
</code></pre></div></div>

<p>constë¡œ ì¸í•´ ì˜¤í•´í•˜ê¸° ì‰½ì§€ë§Œ, refí™”ë¥¼ í•˜ê²Œ ë˜ë©´ ê°œì²´ ìƒíƒœê°€ ë˜ì–´, ìƒíƒœê°€ ë³€ê²½ ë˜ì–´ë„ ê·¸ ê²ƒì´ í•´ë‹¹ ê°œì²´ì— ë°˜ì˜ì´ ëœë‹¤.
ë”°ë¼ì„œ ìœ„ì˜ ê²½ìš° ì•„ë˜ì™€ ê°™ì´ êµ¬ì„±ì„ í•´ë³´ì</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Home.vue (ë¡œì§ì„ ê´€ì¥í•˜ëŠ” íŒŒì¼)</span>
<span class="k">import</span> <span class="nx">usePagination</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./composable/usePagination</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">useFetchData</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./composable/useFetchData</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">defineCompoenet</span><span class="p">({</span>
	<span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
		<span class="kd">const</span> <span class="p">{</span> <span class="nx">page</span><span class="p">,</span> <span class="nx">changePage</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">usePagination</span><span class="p">();</span>
		<span class="kd">const</span> <span class="p">{</span> <span class="nx">getContact</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useFetchdata</span><span class="p">(</span><span class="nx">page</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// usePagination.ts</span>
<span class="kd">const</span> <span class="nx">usePagination</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="nx">page</span> <span class="o">=</span> <span class="nx">ref</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

	<span class="kd">const</span> <span class="nx">changePage</span> <span class="o">=</span> <span class="p">(</span><span class="na">pageNumber</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nx">page</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">pageNumber</span><span class="p">;</span>
	<span class="p">}</span>
	
	<span class="k">return</span> <span class="p">{</span> <span class="nx">page</span><span class="p">,</span> <span class="nx">changePage</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// useFetchData.ts</span>
<span class="kd">const</span> <span class="nx">useFetchData</span> <span class="o">=</span> <span class="p">(</span><span class="nx">page</span><span class="p">:</span> <span class="nx">Ref</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="c1">// Ref&lt;íƒ€ì…ì´ë‚˜ ì¸í„°í˜ì´ìŠ¤&gt;</span>
	<span class="kd">const</span> <span class="nx">parameter</span> <span class="o">=</span> <span class="p">{</span> <span class="na">page</span><span class="p">:</span> <span class="nx">page</span><span class="p">.</span><span class="nx">value</span> <span class="p">}</span>
	
	<span class="kd">const</span> <span class="nx">getContact</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="dl">'</span><span class="s1">/dataget</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="nx">parameter</span> <span class="p">}).</span><span class="kd">get</span><span class="p">()...</span><span class="nx">apicall</span><span class="p">...</span>

		<span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
	<span class="p">}</span>
	
	<span class="k">return</span> <span class="p">{</span> <span class="nx">getContact</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">useFetchDataì—ëŠ”</span> <span class="nx">ìƒë‹¨ì—</span> <span class="cm">/* eslint-disable no-param-reassign */</span> <span class="nx">ë¥¼</span> <span class="nx">ì ìš©í•´ì£¼ì</span><span class="p">.</span>
<span class="nx">íŒŒë¼ë¯¸í„°ë¡œ</span> <span class="nx">ë°›ì€</span> <span class="nx">ê²ƒì„</span> <span class="nx">ë³€ê²½í•˜ë ¤</span> <span class="nx">í•´ì„œ</span> <span class="nx">ì •ì ì¸</span> <span class="nx">ìƒí™©ì—</span> <span class="nx">lint</span> <span class="nx">ë¬¸ë²•ì—</span> <span class="nx">ë§ì•„</span> <span class="nx">ë°œìƒí•˜ëŠ”</span> <span class="nx">ê²ƒì´ê¸°</span> <span class="nx">ë•Œë¬¸ì´ë‹¤</span><span class="p">.</span>
</code></pre></div></div>

<p>ìœ„ ì²˜ëŸ¼ í•„ìš”í•œ ì •ë³´ë“¤ë§Œ ë¹¼ì™€ì„œ ì „ë‹¬í•´ ì£¼ë©´ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , Ref ìƒíƒœì´ê¸° ë•Œë¬¸ì— ì–´ëŠ ê³³ì—ì„œ ë³€ê²½ì´ ì¼ì–´ë‚˜ë„ ë°˜ì˜ëœë‹¤. ê°€ë ¹ ì˜ˆë¥¼ ë“¤ì–´ useFetchData.tsì—ì„œ page.value = 1ë¡œ ë³€ê²½í•´ë„ pageì˜ ê°’ì€ 1ì´ ëœë‹¤.
ë” ë‚˜ì•„ê°€ Ref &amp; Reactiveì˜ ì—¬ëŸ¬ ê²½ìš°ë¥¼ ë‹¤ë¤„ ë³¼ ìˆ˜ ë„ ìˆì§€ë§Œ, ì´ë¯¸ ì •ë¦¬ë˜ì–´ ìˆëŠ” ì •ë³´ë“¤ì´ ë§ìœ¼ë‹ˆ ì°¾ì•„ë³´ëŠ”ê²Œ ë” ì¢‹ì„ ê²ƒ ê°™ë‹¤. íŠ¹íˆ ì•„ë˜ì˜ ë§í¬ê°€ ì¢‹ë‹¤.</p>

<p><a href="https://www.danvega.dev/blog/2020/02/12/vue3-ref-vs-reactive/">https://www.danvega.dev/blog/2020/02/12/vue3-ref-vs-reactive/</a></p>

<h2 id="2-this-ì‚¬ìš©í•˜ê¸°">2. this ì‚¬ìš©í•˜ê¸°</h2>

<p>Vue 3ëŠ” this ì‚¬ìš©ì„ í•˜ì§€ ì•ŠëŠ” ë°©í–¥ìœ¼ë¡œ ë‚˜ì•„ê°€ê³  ìˆë‹¤. ì•„ë¬´ë˜ë„ ìº¡ìŠí™”ì˜ ë¬¸ì œê°€ ìˆê¸° ë•Œë¬¸ì´ë¼ê³  ìƒê°ë˜ëŠ”ë°, í™•ì‹¤íˆ compositionì„ ì‚¬ìš©í•¨ìœ¼ë¡œì„œ ë³´ì—¬ì¤„ ê²ƒë§Œ ë³´ì—¬ì£¼ëŠ” ì—­í• ì€ ìˆë‹¤ê³  ìƒê°í•œë‹¤. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” Vue 2 í”„ë¡œì íŠ¸ì—ì„œ compositionì„ ë„ì…í–ˆë‹¤. ê´€ì‹¬ì‚¬ ë³„ë¡œ ë¶„ë¦¬í•˜ëŠ” ê¸°ëŠ¥ì´ ë„ˆë¬´ ê°•ë ¥í•œë°, thisë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•˜ëŠ” ì´ìœ ë¡œ ì‚¬ìš©í•˜ì§€ ëª»í•˜ëŠ” ê²ƒì€ ì•„ë‹ê¹Œ? ë¼ëŠ” ê³ ë¯¼ì„ í–ˆë˜ ê²ƒ ê°™ë‹¤. ë”°ë¼ì„œ thisë¥¼ ì‚¬ìš©í•˜ëŠ” ë‘ ê°€ì§€ ë°©ë²•ì„ ì†Œê°œí•˜ë ¤ í•œë‹¤.</p>

<p>1) context ì‚¬ìš©</p>

<p>setup()ë¥¼ ì‚¬ìš©í•˜ë‹¤ ë³´ë©´ ë‘ ê°€ì§€ íŒŒë¼ë¯¸í„°ë¥¼ ìì£¼ ë³´ê²Œ ë  ê²ƒì´ë‹¤. ë°”ë¡œ <code class="language-plaintext highlighter-rouge">props</code>, <code class="language-plaintext highlighter-rouge">context</code>ì´ë‹¤.
ì´ context ì•ˆì— rootë¥¼ ì ‘ê·¼í•˜ë©´ thisì™€ ê°™ì€ ì—­í• ì„ í•˜ê²Œ ëœë‹¤.
í•˜ì§€ë§Œ ì´ëŠ” Vue 3ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ê²Œ ë˜ì—ˆë‹¤. ì´ìœ ëŠ” thisë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒê³¼ ê°™ì€ ê²°ì´ì§€ ì•Šì„ê¹Œ ì‹¶ë‹¤.
thisë¥¼ ì‚¬ìš©í•˜ë©´ì„œ router, store, eventbus etcâ€¦ ë§ì€ ê²ƒì„ Vue 2ì—ì„œ ì‚¬ìš©í–ˆëŠ”ë° ë‹¹í™©í•˜ì§€ ì•Šì„ ìˆ˜ê°€ ì—†ë‹¤.
Vue 3ëŠ” router, storeì˜ íƒ€ì… ì •ì˜ë‚˜ ì‚¬ìš© í•˜ëŠ” ë°©ë²•ì´ ì¡´ì¬ í•˜ì§€ë§Œ ì´ë¥¼ ìœ„í•´ Vue2ì˜ ë¼ìš°í„°ë¥¼ ë°”ê¿€ ìˆ˜ëŠ” ì—†ëŠ” ë…¸ë¦‡ì´ì—ˆë‹¤. (ê·¸ëŸ´ë°”ì—” ì°¨ë¼ë¦¬ Vue3ë¡œ ë„˜ì–´ê°€ì§€â€¦)
ê·¸ëŸ¬ë‚˜, Vue2ì— compositionì„ ì ìš©í•œ ë§Œí¼ deprecated(ë¹„ê¶Œì¥) ë˜ì–´ ìˆê¸´ í•˜ì§€ë§Œ, Vue3ì—ì„œëŠ” ëª»ì“°ì§€ë§Œ Vue2ì—ì„œëŠ” ì´ëŸ¬ë¼ê³  ì“¸ ìˆ˜ ìˆê²Œ ë‚¨ê²¨ ë†“ì€ ê²ƒì´ë¼ê³  ìƒê°í•œë‹¤!
compositionì˜ ì¥ì ì„ ì‚´ë¦¬ê³  thisë„ ê¸°ì¡´ ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•œ ë°©ë²•ì´ë‹¤.</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setup</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span> <span class="nx">context</span><span class="p">){</span>
	<span class="nx">context</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">xxx</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">context</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">...;</span>
  <span class="nx">context</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">$eventHub</span><span class="p">....;</span>
	<span class="cm">/*rootì— ì¤„ì´ ê·¸ì–´ì§€ê³  @deprecated â€” not available in Vue 3 ê°€ ìƒê¸¸ ê²ƒì´ë‹¤.*/</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ê·¸ëŸ¬ë‚˜ ìš°ë¦¬ê°€ composable í•˜ê²Œ íŒŒì¼ì„ ìƒì„±í–ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ íŒŒì¼ì—ë„ thisê°€ í•„ìš”í•  ìˆ˜ë„ ìˆë‹¤.
ê·¸ëŸ´ ë•ŒëŠ” ì•„ë˜ì™€ ê°™ì´ contextë¥¼ ì „ë‹¬í•˜ì.</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Home.vue</span>
<span class="nx">setup</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="p">{</span> <span class="nx">fetchData</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useFetchData</span><span class="p">(</span><span class="nx">context</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// useFetchData.ts</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">SetupContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@vue/compositon-api</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">useFetchData</span> <span class="o">=</span> <span class="p">(</span><span class="nx">context</span><span class="p">:</span> <span class="nx">SetupContext</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="c1">// contextì˜ íƒ€ì…ì€ SetupContext</span>
		<span class="nx">context</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">xxx</span><span class="dl">'</span><span class="p">);</span>
		<span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>2) proxy ì‚¬ìš©</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// useFetchData.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">ComponentInternalInstance</span><span class="p">,</span> <span class="nx">getCurrentInstance</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@vue/composition-api</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// proxyë¥¼ ì‚¬ìš©í•  ê±´ë°,ì´ ì´ë¦„ì„ $thisë¡œ ë³„ë„ ì§€ì •í•˜ë©´, Vue2ì—ì„œ thisë¥¼ ì‚¬ìš©í•˜ëŠ” ëŠë‚Œê³¼ ë¹„ìŠ·í•´ì§„ë‹¤.</span>

<span class="kd">const</span> <span class="p">{</span> <span class="na">proxy</span><span class="p">:</span> <span class="nx">$this</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">getCurrentInstance</span><span class="p">()</span> <span class="k">as</span> <span class="nx">ComponentInternalInstance</span><span class="p">;</span>

<span class="nx">$this</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">xxx</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="3-class-íƒ€ì…-ì •ì˜">3. class íƒ€ì… ì •ì˜</h2>

<p>classë¡œ ë§Œë“  ì»´í¬ë„ŒíŠ¸ê°€ ìˆë‹¤ë©´, Ref ì„¤ì • ë•Œë¬¸ì— í•´ë‹¹ í´ë˜ìŠ¤ë„ íƒ€ì… ì„¤ì •ì„ í•´ì¤˜ì•¼ í•œë‹¤.</p>

<p>ì•„ë˜ì˜ ì˜ˆë¥¼ ì‚´í´ë³´ì</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">PaginateClass</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@í•´ë‹¹ PaginateClassíŒŒì¼</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">state</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">({</span>
	<span class="na">keyword</span><span class="p">:</span> <span class="dl">''</span> <span class="k">as</span> <span class="kr">string</span><span class="p">,</span>
	<span class="na">paginateClass</span><span class="p">:</span> <span class="kc">null</span> <span class="k">as</span> <span class="nx">PaginateClass</span> <span class="o">|</span> <span class="kc">null</span>
<span class="p">})</span>
</code></pre></div></div>

<p>ì´ ë•Œ paginateClassë¥¼ íƒ€ì…ì •ì˜ í•  ë•ŒëŠ” í•´ë‹¹ í´ë˜ìŠ¤ íŒŒì¼ì„ ì‚¬ìš©í•˜ë©´ ë˜ëŠ”ë°, stateë¼ëŠ” refë¡œ ë¬¶ì´ê²Œ ëœë‹¤.
ì´ ìƒíƒœì—ì„œ 1) ë•Œì™€ ê°™ì´ state ë¼ëŠ” refë¥¼ ì „ë‹¬í•˜ë©´ íƒ€ì…ì •ì˜ ë¬¸ì œê²Œ ë´‰ì°©í•˜ê²Œ ëœë‹¤.
stateë¼ëŠ” refë¥¼ ë°›ëŠ” composable íŒŒì¼ì€ ì´ stateì˜ íƒ€ì…ì„ ì •ì˜ë¥¼ ìš”êµ¬í•œë‹¤.</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">State</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./types</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">useStateRef</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span><span class="p">:</span> <span class="nx">Ref</span><span class="o">&lt;</span><span class="nx">State</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ê·¸ëŸ¼ types íŒŒì¼ì— ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•˜ëŠ”ë°, ì´ ë•ŒëŠ” í´ë˜ìŠ¤ì˜ ëª¨ë“  ë©”ì†Œë“œë“¤ì„ ê°ê° ì •ì˜ë¥¼ ìš”êµ¬í•˜ëŠ”ë°, ë‹¹í™©í•˜ê±°ë‚˜ ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜ë¥¼ ìš”í•œë‹¤.</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// type.ts</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">State</span> <span class="p">{</span>
	<span class="nl">keyword</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
	<span class="nl">paginateClass</span><span class="p">:</span> <span class="nx">PaginateClass</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">PaginateClass</span> <span class="p">{</span>
	<span class="nl">getPage</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="kr">number</span><span class="p">;</span>
	<span class="nl">getLimit</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="kr">number</span><span class="p">;</span>
	<span class="p">...</span>
	<span class="nx">clickPage</span><span class="p">:</span> <span class="p">(</span><span class="nx">pageNumber</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
	<span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>
:ET